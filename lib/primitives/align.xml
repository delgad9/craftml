<craft name="align">
    <parameter name="x" default="null" type="percent"/>
    <parameter name="y" default="null" type="percent"/>
    <parameter name="z" default="null" type="percent"/>
    <content></content>
    <script type="text/craftml">

        function min(axis, solids) {
            return _.min(solids.map(function(c) {
                return c.layout.location[axis]
            }))
        }

        function max(axis, solids) {
            return _.max(solids.map(function(c) {
                return c.layout.location[axis] + c.layout.size[axis]
            }))
        }      

        function _do_alignment(solids, dim, percent){
            
            var m = min(dim, solids)            

            solids.forEach(function(solid) {

                var newPos
                newPos = m - solid.layout.size[dim] * percent / 100            
                solid.layout.location[dim] = newPos                 
            })
        }

        function main(params, scope) {

            var a = params.axis

            var contentSolids = scope.solids

            _.forEach(['x','y','z'], function(dim){

                if (!isNaN(params[dim])) {

                    _do_alignment(contentSolids, dim, params[dim])

                }

            })

        }

    </script>
</craft>