<craft name="align">
    <parameter name="x" default="null" type="percent"/>
    <parameter name="y" default="null" type="percent"/>
    <parameter name="z" default="null" type="percent"/>
    <content></content>
    <script type="text/craftml">

        // function min(axis, solids) {
        //     return _.min(solids.map(function(c) {
        //         return c.layout.location[axis]
        //     }))
        // }

        // function max(axis, solids) {
        //     return _.max(solids.map(function(c) {
        //         return c.layout.location[axis] + c.layout.size[axis]
        //     }))
        // }      

        // function _do_alignment(solids, dim, percent){
            
        //     var m = min(dim, solids)            

        //     var newLoc
        //     solids.forEach(function(solid) {

        //         newLoc[dim] = m - solid.layout.size[dim] * percent / 100            
        //         solid.layout.location[dim] = newPos                 
        //     })
        // }

        function main(params, scope) {

            if (scope.solids.length === 0){
                return
            }
            
            var first = scope.solids[0]

            scope.solids.slice(1).forEach(function(solid) {

                var newLoc = _.clone(solid.layout.location)

                _.forEach(['x','y','z'], function(dim){

                    var percent = params[dim]

                    if (!isNaN(percent)) {

                        newLoc[dim] = first.layout.location[dim] + 
                            (first.layout.size[dim] - solid.layout.size[dim]) * percent / 100                           
                    }
                })

                solid.translateTo(newLoc)
            })
        }

    </script>
</craft>